/** 
 * 原链接：https://gw.alipayobjects.com/as/g/component/mypaTracert/3.1.2/index.js
 * 修改内容如下：
 * tracert --> mypaTracert
 * MypaTracert --> MypaTracert
 * _send() 增加传参 "&_input_charset=utf-8"
 * ["AP", "AF", "AFW", "BK", "AM", "APHK", "KB"] 的逻辑删除
 * 请求地址 https://mdap.alipay.com/loggw/dwcookieLogGet.do 修改成 spmRecord.json
*/

var localUrl = window.location.href;
var curEnv = "http://csmobile-eu95-34.gz00b.dev.alipay.net/spmRecord.json";

if (/\.com/.test(localUrl)) {
  curEnv = "https://csmobiledata.alipay.com/spmRecord.json";
}

// spm 改造 spmRecord

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e=e||self).__tracert=e.__tracert||{},e.__tracert.starter=t())}(this,function(){"use strict";function e(e,t,n){var o=t||window.document;o.addEventListener?o.addEventListener(e,n,!0):o.attachEvent?o.attachEvent("on".concat(e),n):o[e]=n}function t(e,t,n){var o=t||window.document;o.removeEventListener?o.removeEventListener(e,n,!0):o.detachEvent?o.detachEvent("on".concat(e),n):o[e]=n}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;t.length>n;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(t){"interactive"===document.readyState||"complete"===document.readyState?t():e("DOMContentLoaded",document,t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};for(var o in e){if(e.hasOwnProperty(o))n[0===o.indexOf(t)?o:t+o]=e[o]}return n}function i(e,t){var n=e||{};for(var o in t)t.hasOwnProperty(o)&&void 0!==t[o]&&(n[o]=t[o]);return n}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;if(!e)return"";var n="",o=window.AlipayJSBridge;try{n=RegExp("(?=\\?|\\&|\\b|^)".concat(e,"\\=(.+?)(?=\\&|$)")).exec(t),n=decodeURIComponent(n=n?"".concat(n[1]):"")}catch(e){console.warn(e)}return""===n&&(n=o&&o.startupParams&&o.startupParams[e]),n}function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",o=[];if(e instanceof Array)o=e;else if(e instanceof Object)for(t in e)e.hasOwnProperty(t)&&o.push("".concat(t,"=").concat(e[t]));return o.join(n)}function l(e){if("string"!=typeof e)return null;var t=e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^");if(-1===e.indexOf("="))return t;for(var n,o,r=t.length,a={},i=0;r>i;i++)(n=t[i])&&(a[(o=n.split("="))[0]]=o[1]||"");return a}var u=i,d=s;function f(e,t){var n=e||{},o=t||{};if(!o.spmId||"mergeExpose"!==o.actionId)return n;if(3===o.spmId.split(".").length){var r=o.spmId;n[r]||(n[r]={},n[r]=u({},o))}return n}function p(e,t){var n=e||{},o=t||{};if(!o.spmId||"mergeExpose"!==o.actionId)return null;if(3===o.spmId.split(".").length){var r=o.spmId;n[r]||(n[r]={});var a="";o.param4&&o.param4.rid?(a=o.param4.rid,delete o.param4.rid):a="",n[r][a]?n[r][a].push(o.param4):(n[r][a]=[],n[r][a].push(o.param4))}return n}function m(e,t){var o=[],r=["fullURL","mBizScenario","mPageState","mPageName","version"];if("object"===n(e))for(var a in e)if(e.hasOwnProperty(a)){var i={};t?i=u(i,t[a]):(i.spmId=a,i.actionId="mergeExpose");var c=[];if(e[a].options)i.param4=d(e[a].options.param4);else{for(var s in e[a])if(e[a].hasOwnProperty(s)){for(var l=[],f=e[a][s],p=0;f.length>p;p++){var m=[],h=f[p];for(var v in h)h.hasOwnProperty(v)&&-1===r.indexOf(v)&&m.push("".concat(v,"|").concat(h[v]));l.push(m.join(";"))}c.push("rid|".concat(s,":").concat(l.join("&")))}i.param4="exposed=".concat(c.join("__"))}o.push(i)}return o}var h="data-aspm",v="data-aspm-click",g=/^a|area$/i;function y(e){var t,n;try{return t=[].slice.call(e)}catch(r){t=[],n=e.length;for(var o=0;n>o;o++)t.push(e[o]);return t}}function b(e,t){return e&&e.getAttribute&&e.getAttribute(t)||""}function w(e){return null!==e&&"object"===n(e)&&1===e.nodeType}function I(e){return!(!e||!w(e)||e===document.body||e===document.documentElement)}function _(e){for(var t,n,o,r,a,i=y(e||document.getElementsByTagName("meta")),c=i.length,s=0;c>s;s++){switch(n=b(t=i[s],"name"),o=b(t,"content"),n){case h:a=o;break;case"data-bizType":r=o}if(a&&r)break}var l={};return a&&(l.spmAPos=a),r&&(l.bizType=r),l}function x(){return b(document.body,h)}function S(e){var t=e;if(!I(t))return"";for(var n="";t&&t!==document.body&&!(n=b(t,h));)t=t.parentNode;return n}function P(e){var t=e;if(!I(t))return"null";do{if(g.test(t.tagName)||t.hasAttribute(v))return t}while((t=t.parentNode)&&t&&t.tagName&&"BODY"!==t.tagName&&t!==document.body&&!b(t,h));return null}function O(e){var t=e;if(!I(t))return"";if(g.test(t.tagName)||t.hasAttribute(v)||(t=P(t)),!t)return"";var n=b(t,v),o=t.tagName;if(("string"==typeof n||g.test(o))&&!n){var r=0,a=t;do{w(a)&&o===a.tagName&&r++,a=a.previousSibling}while(a);n=r}return"".concat(n)}function A(e){var t=e&&e.getAttribute&&e.getAttribute("data-aspm-param")||"",n={};if(t){var o=t.split("^");if(-1===t.indexOf("="))n=o;else for(var r,a,i=o.length,c=0;i>c;c++)(r=o[c])&&(n[(a=r.split("="))[0]]=a[1]||"")}return n}function E(){for(var e=0,t={};arguments.length>e;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}var j=function e(t){function n(e,o,r){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(r=E({path:"/"},n.defaults,r)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*r.expires),r.expires=i}r.expires=r.expires?r.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}o=t.write?t.write(o,e):encodeURIComponent(o+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(e+"")).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var s in r)r[s]&&(c+="; "+s,!0!==r[s]&&(c+="="+r[s]));return document.cookie=e+"="+o+c}e||(a={});for(var l=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;l.length>d;d++){var f=l[d].split("="),p=f.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var m=f[0].replace(u,decodeURIComponent);if(p=t.read?t.read(p,m):t(p,m)||p.replace(u,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(e===m){a=p;break}e||(a[m]=p)}catch(e){}}return a}}return n.set=n,n.get=function(e){return n.call(n,e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,t){n(e,"",E(t,{expires:-1}))},n.withConverter=e,n}(function(){});function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||400>t.length||!n.cookie&&window.localStorage)if(window.localStorage)try{window.localStorage.setItem(e,t)}catch(o){j.set(e,t,n)}else j.set(e,t,n);else console&&console.warn&&console.warn("MypaTracert cookie set too long")}new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"set",value:function(){var e,t,n,o=[].slice.call(arguments);2>o.length?this._set(o):this._set((n=o[1],(t=o[0])in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),o[2]||{})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="".concat("_TRACERT_COOKIE_","_").concat(e),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.localStorage&&window.localStorage.getItem(e)||j.get(e,t);if(j.get(e,t)&&window.localStorage)try{window.localStorage.setItem(e,n),j.remove(e,t)}catch(e){console&&console.warn&&console.warn("localstorage error")}return n}(o,t);return n&&function(e,t){window.localStorage&&window.localStorage.removeItem(e),j.remove(e,t)}(o),r}},{key:"_set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&0!==Object.keys(e).length)for(var n in e){if(e.hasOwnProperty(n))k("".concat("_TRACERT_COOKIE_","_").concat(n),e[n],t)}}}])&&o(t.prototype,n),r&&o(t,r),e}());function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;t.length>n;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){L(e,t,n[t])})}return e}function R(e){return function(e){if(Array.isArray(e))return e}(e)||D(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function M(e){return function(e){if(Array.isArray(e)){for(var t=0,n=[];e.length>t;t++)n[t]=e[t];return n}}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function D(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var z=function(e){console&&console.warn&&console.warn("MypaTracert deprecated：".concat(e))},J=document,N=function(){function n(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var r={autoLogPv:!0,eventType:"click",autoExpo:!1,bizType:"H5behavior",state:"",name:"",logLevel:"2",mdata:{},seedIdPrefix:"",seedIdSuffix:"",spmAPos:"",spmBPos:"",bizScenario:c("bizScenario")||"",paramPrefix:"",debug:!1,server:"",lastClkSpm:"",url:location.href.split(/\?|#|;jsessionid=/)[0],referSPM:"",srcSpm:"",sessionIdKey:"mypaTracert-session-key",seedIdCfg:{pageSeedId:"H5_MTRACKER_AP_PAGE",clkSeedId:"H5_MTRACKER_AP_CLK",calcSeedId:"H5_MTRACKER_AP_CALC",expoSeedId:"H5_MTRACKER_AP_EXPO",syslogSeedId:"H5_MTRACKER_AP_SYSLOG"},_plugins:[],platformType:"",ready:!1,apiCashList:[],timeMap:{},expoOnce:!1,_wap_intervalEx:400,_wap_interval:300,_wap_mgObjIndex:0,_wap_exObjIndex:0,_wap_mgTdObjIndex:0,_expoMergeItvObj:0,hasExpoMerge:!1,fmtedExObjArr:[],fmtedExObj:{},fmtedExOptions:{},cacheExObjArr:[],cacheMrExObjArr:[],expotTimeout:300,expoObj:{},expoType:function(n){var o=!1;e("scroll",J,function r(){o||(o=!0,t("scroll",J,r),setTimeout(function(){o=!1,e("scroll",J,r)},300),n())})},expoSection:[-.3,.3],_beforeEvObj:{logPv:[],click:[],expo:[],set:[],send:[]},_afterEvObj:{start:[],logPv:[],click:[],expo:[]},_pluginLoadCnt:0,sysInfo:{}};i(r,o),i(this,r);var a=window.TracertCmdCache;if(a&&a.length)for(var s=0;a.length>s;s++){var l=R([].slice.call(a[s])),u=l[0],d=l.slice(1);this.call.apply(this,[u].concat(M(d)))}this._start()}var o,s,l;return o=n,(s=[{key:"before",value:function(e,t){var n=this._beforeEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");n[e].push(t)}},{key:"_runBeforeFns",value:function(e,t){var n=this._beforeEvObj[e]||[];if(!n||!n.length)return!0;for(var o=0;n.length>o;o++){if(!1===n[o].call(this,t))return console&&console.debug&&console.debug("MypaTracert before fns: ".concat(e," stop propagation")),!1}return!0}},{key:"after",value:function(e,t){var n=this._afterEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");"start"===e&&this.ready?t():n[e].push(t)}},{key:"_runAfterFns",value:function(e,t){var n=this._afterEvObj[e]||[];if(n&&n.length)for(var o=0;n.length>o;o++)n[o].call(this,t)}},{key:"init",value:function(){}},{key:"load",value:function(e){r(e)}},{key:"onReady",value:function(e){this.ready?e&&e():document.addEventListener("TracertOnReady",function(){e&&e()})}},{key:"_start",value:function(){var e=this,t=function(){e.load(function(){if(!e.ready){var t=_();t.spmAPos=e.spmAPos||t.spmAPos,e.spmBPos||(t.spmBPos=x()),e.set(t),e.ready=!0;for(var n=0;e.apiCashList.length>n;n++){e.call.apply(e,e.apiCashList[n])}e._runAfterFns("start"),e.apiCashList=[]}})};this.pluginReady&&this.started?t():(document.addEventListener("TracertPluginReady",function(){e.started&&t()}),document.addEventListener("TracertStart",function(){e.pluginReady&&t()}))}},{key:"start",value:function(){this.run(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"run",value:function(){this.set(B({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{started:!0}));var e=document.createEvent("HTMLEvents");e.initEvent("TracertStart",!0,!0),document.dispatchEvent(e),this.autoLogPv&&this.call("logPv")}},{key:"loadPlugins",value:function(e){if(e&&e.length){this._plugins=e;for(var t=0;e.length>t;t++){this.loadPlugin(e[t])}}}},{key:"loadPlugin",value:function(e){var t=this;e&&((window["mypaTracert".concat(e)]&&"function"==typeof window["mypaTracert".concat(e)]||"function"==typeof e)&&("function"==typeof e?e:window["mypaTracert".concat(e)])(this,function(){if(t._pluginLoadCnt++,t._pluginLoadCnt===t._plugins.length){t.set({pluginReady:!0});var e=document.createEvent("HTMLEvents");e.initEvent("TracertPluginReady",!0,!0),document.dispatchEvent(e)}}))}},{key:"call",value:function(){var e,t=[].slice.call(arguments);if(!t[0]||"run"!==t[0]&&"start"!==t[0]||this.set({started:!0}),this.ready){if(!this[t[0]]||"function"!=typeof this[t[0]])return console.warn("未找到方法：".concat(t[0])),null;var n=t.slice(1);n=this.optionsHandle(n),e=this[t[0]].apply(this,n)}else this.apiCashList.push(t);return e}},{key:"optionsHandle",value:function(e){return e&&e.length?(e.forEach(function(e){var t=e;t&&(t.spmid&&(t.spmId=t.spmid),t.seedid&&(t.seedId=t.seedid),t.ucid&&(t.ucId=t.ucid))}),e):e}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._runBeforeFns("set",e),e.eventName&&i(e,{eventType:e.eventName}),"object"===T(e.mdata)&&(e.mdata=B({},this.mdata,e.mdata)),i(this,e)}},{key:"getSysInfo",value:function(e){return this.sysInfo[e]}},{key:"setSysInfo",value:function(){i(this.sysInfo,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"config",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};z("请使用 set 方法"),this.set(e)}},{key:"remoteLog",value:function(){}},{key:"logPv",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._runBeforeFns("logPv",e)&&(this._logPv(e),this._runAfterFns("logPv",e))}},{key:"_logPv",value:function(){}},{key:"report",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=e.spmId;if(n){var o=n.split("."),r=o[0],a=o[1];r&&a&&this.set({spmAPos:r,spmBPos:a})}"object"===T(t)&&this.set({mdata:B({},this.mdata,t)}),this.set({_calledLogPv:!!n}),this.call("logPv")}},{key:"pageState",value:function(){this.set({state:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}),this.call("logPv")}},{key:"pageName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";z("已废弃"),this.set({name:e})}},{key:"setPageState",value:function(){this.call("pageState",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},{key:"time",value:function(){var e="".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),t=this.timeMap;e&&!t[e]&&(t[e]=new Date-0)}},{key:"timeEnd",value:function(){var e="".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),t=this.timeMap;if(!e||!t[e])return"";var n=t[e],o=new Date-0-n;return delete t[e],o}},{key:"_goRemotelog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.seedId||e.spmId){var t=e.spmId||e.spmid||"",n=t.split("."),o=this.spmAPos,r=this.spmBPos;if(o&&r)switch(n.length){case 1:case 2:if(""===t)break;if(0!==t.indexOf("c"))break;t=[o,r,t].join(".")}var a={ucId:e.ucId,seedId:e.seedId,spmId:t,actionId:e.actionId,logLevel:e.logLevel||this.logLevel,param4:e.mdata||{}};if(e.type&&(a.type=e.type),e.params&&"object"===T(e.params))if(e.params.length)i(a,{param1:e.params[0]||"",param2:e.params[1]||"",param3:e.params[2]||""});else{var c=e.mdata||{};i(c,e.params),i(a.param4,c)}if(e.timeKey){var s=this.call("timeEnd",e.timeKey);s&&(a.param4.consume=s)}this.call("remoteLog",a)}else console.warn("请填入埋点seedId或spmId")}},{key:"info",value:function(){this._goRemotelog(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"error",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(e,{type:"error",actionId:"exception"}),this._goRemotelog(e)}},{key:"click",value:function(){var e={spmId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",extra:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},options:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}};if(this._runBeforeFns("click",e)){var t=e.spmId.split(":"),n=t[1]?{seedDesc:t[1]}:{};i(n,a(e.extra,this.paramPrefix));var o={param1:this.url,param2:t[0],param4:n,seedId:this.seedIdCfg.clkSeedId,actionId:"clicked",spmId:t[0]};i(o,e.options),this.set({lastClkSpm:e.spmId}),this.call("remoteLog",o,!0),this._runAfterFns("click",e)}}},{key:"expo",value:function(){var e={spmId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",offset:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up",extra:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}};if(this._runBeforeFns("expo",e)){var t={param1:this.url,param2:e.spmId,param3:e.offset,param4:a(e.extra,this.paramPrefix),seedId:this.seedIdCfg.expoSeedId,actionId:"exposure",spmId:e.spmId};this.expoObj=this.expoObj||{},!1!==this.expoObj[e.spmId]?(this.expoOnce&&(this.expoObj[e.spmId]=!1),this.call("remoteLog",t),this._runAfterFns("expo",e)):console.warn("该埋点已经曝光过了")}}},{key:"calc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};z("calc 已废弃");var o={param1:this.url,param2:e,param3:t,param4:a(n,this.paramPrefix),seedId:this.seedIdCfg.calcSeedId,actionId:"timestamp"};this.call("remoteLog",o)}}])&&C(o.prototype,s),l&&C(o,l),n}();var F=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var U=function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){F(e,t,n[t])})}return e};var H,K=(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(o){return e.exports=n="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},n(o)}e.exports=n}(H={exports:{}},H.exports),H.exports),q=function(e,t){var n=t.key,o=t.value,r=e;r.mdata=r.mdata||{},o&&(r.mdata[n]=o,r[n]=o)},V=function(e,t){var n=t.reset,o=e;document.addEventListener(t.eventName,function(){if(!o.hasExpoMerge){for(var e=0;o.fmtedExObjArr.length>e;e++)window.AlipayJSBridge.call("remoteLog",o.fmtedExObjArr[e]);n&&(o.hasExpoMerge=!0)}},!1)},W=function(e){var t=e,n=window.AlipayJSBridge;if(n&&n.startupParams&&n.startupParams.extLogInfo&&0===t._apCurrentIndex)try{var o=n.startupParams.extLogInfo;"string"==typeof o&&(o=JSON.parse(o));var r=o.pageId;if(!r)return;var a=r.split("__")[0].split(".");a[0]&&a[1]&&2===a.length&&t.call("config",{spmAPos:a[0],spmBPos:a[1],autoLogPv:!1})}catch(e){console.warn("解析extLogInfo失败",e)}},G=function(e){var t=e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})||{},o=n.seedId;t.seedIdPrefix&&(o="".concat(t.seedIdPrefix,"-").concat(o)),t.seedIdSuffix&&(o="".concat(o,"-").concat(t.seedIdSuffix));var r=n.spmId||"",a=r.split("."),c=t.spmAPos,s=t.spmBPos;if(c&&s)switch(a.length){case 1:if(""===r){delete n.spmId;break}n.spmId=[c,s,r].join(".");break;case 2:n.spmId=[c,s,r].join(".");break;case 3:case 4:break;default:n.param2=r,delete n.spmId}else delete n.spmId;var l={mBizScenario:t.mdata.bizScenario,mPageState:t.state,mPageName:t.name,role_id:t.roleId||t.role_id,fullURL:location.href},u=n.param4||{};if(i(u,l),t.mdata&&"object"===K(t.mdata))for(var d in t.mdata)t.mdata.hasOwnProperty(d)&&(u[d]=u[d]||t.mdata[d]);return i(n,{type:n.type||"monitor",bizType:n.bizType||t.bizType,logLevel:parseInt(n.logLevel||t.logLevel,10),actionId:n.actionId||"clicked",param4:u,seedId:o}),n},Y={_calledLogPv:!1,init:function(){q(this,{key:"bizScenario",value:c("bizScenario")}),q(this,{key:"version",value:c("version")}),q(this,{key:"appId",value:c("appId")}),q(this,{key:"chInfo",value:c("chInfo")||c("chinfo")}),q(this,{key:"cityid",value:c("cityId")||c("cityid")}),V(this,{eventName:"collectDestroyJsApi",reset:!0}),V(this,{eventName:"back",reset:!0}),V(this,{eventName:"pause"}),W(this)},remoteLog:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=G(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),n={};if(i(n,t),this.debug){var o={};i(o,t),console.log(o)}if("mergeExpose"===n.actionId&&n.spmId&&3===n.spmId.split(".").length&&n.param4)return this.fmtedExOptions=f(this.fmtedExOptions,i({},n)),this.fmtedExObj=p(this.fmtedExObj,i({},n)),void(this.fmtedExObjArr=m(this.fmtedExObj,this.fmtedExOptions));e&&t.spmId&&(delete t.param1,delete t.param2,delete t.param3,(this.entityId||t.entityId)&&(t.entityId=t.entityId||this.entityId),window.AlipayJSBridge.call("autoClick",{param:t})),n.param4=s(n.param4),window.AlipayJSBridge.call("remoteLog",n)},_logPv:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._calledLogPv&&window.AlipayJSBridge.call("pageMonitor",{actionType:"end"}),this._calledLogPv=!0,this.call("pageMonitor",e)},report:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=e.spmId;if(n){var o=n.split("."),r=o[0],a=o[1];r&&a&&this.set({spmAPos:r,spmBPos:a})}"object"===K(t)&&this.set({mdata:U({},this.mdata,t)});var i=!!n;i&&this._calledLogPv&&window.AlipayJSBridge.call("pageMonitor",{actionType:"end"}),i&&this.set({_calledLogPv:!0}),this.call("pageMonitor")},pageMonitor:function(e){var t=this.bizType,n=this.spmAPos&&this.spmBPos?[this.spmAPos,this.spmBPos].join("."):"",o={url:this.url,bizType:t,isSPM:!!n};n&&(o.spmId=n),this.entityId&&(o.entityId=this.entityId);var r={spm:o,spmDetail:U({},this.mdata,{url:this.url,fullUrl:location.href,mPageState:this.state,mBizScenario:this.bizScenario},e)};this.debug&&console.log(r),window.AlipayJSBridge.call("reportData",r)},available:function(e){var t=window.AlipayH5Performance;if(t){var n=e;e instanceof Object&&"object"===K(e.params)&&(n=e.params),t.addTrackData({name:"timeReport",value:s(n,"|")})}}},X=function(e){var t={},n=e.match(/AliApp\S+\b\)/gi);return t.is=!!/(T-UA)|(TBIOS)|(WindVane)|(AliApp)/i.test(e),t.name=n?n[0].match(/\(\w+\-*\w*/)[0].split("(")[1]:"",t.version=n?n[0].match(/(\d+\.*)+/gi)[0]:"",t},$={},Q="-1",Z=navigator.userAgent||"",ee=navigator.appVersion||"",te=navigator.vendor||"";function ne(e){return Object.prototype.toString.call(e)}var oe=[["wp",function(e){return-1!==e.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==e.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==e.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["ios",function(e){return/\bcpu(?: iphone)? os /.test(e)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==e.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",/\bandroid[\/\- ]?([0-9.x]+)?/],["linux","linux"]],re=[["qq",/\bm?qqbrowser\/([0-9.]+)/],["ie",/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["uc",function(e){return 0>e.indexOf("ucbrowser/")?/\buc\/[0-9]/.test(e)?/\buc\/([0-9.]+)/:0>e.indexOf("ucweb")?/\b(?:ucbrowser|uc)\b/:/\bucweb[\/]?([0-9.]+)?/:/\bucbrowser\/([0-9.]+)/}],["android",function(e){if(-1!==e.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/]];function ae(e,t,n){var o="[object Function]"===ne(t)?t.call(null,n):t;if(!o)return null;var r={name:e,version:Q,codename:""};"android"===e&&(r.type=n.indexOf("Mobi")>-1?"phone":"pad"),"ios"===e&&(r.type=n.indexOf("iPhone")>-1?"phone":"pad");var a=ne(o);if(!0===o)return r;if("[object String]"===a){if(-1!==n.indexOf(o))return r}else{if(function(e){return"[object Object]"===ne(e)}(o))return o.hasOwnProperty("version")&&(r.version=o.version),r;if(o.exec){var i=o.exec(n);if(i)return r.version=i.length>=2&&i[1]?i[1].replace(/_/g,"."):Q,r}}}var ie={name:"na",version:Q};function ce(e,t,n,o){var r=ie;!function(e,t,n){for(var o=0,r=e.length;r>o&&!1!==t.call(e,e[o],o);o++);}(t,function(t){var n=ae(t[0],t[1],e);if(n)return r=n,!1}),n.call(o,r.name,r.version)}var se=function(e){e=(e||"").toLowerCase();var t={};return ce(e,oe,function(e,n){var o=parseFloat(n);t.os={name:e,version:o,fullVersion:n},t.os[e]=o},t),ce(e,re,function(e,n){var o=parseFloat(n);t.browser={name:e,version:o,fullVersion:n},t.browser[e]=o},t),t};($=se(Z+" "+ee+" "+te)).parse=se,$._checkApp=X,$.app=$._checkApp(Z);var le,ue,de,fe,pe=$,me=window,he="nameStorage:",ve=/^([^=]+)(?:=(.*))?$/,ge="?",ye="=",be="&",we=encodeURIComponent,Ie=decodeURIComponent,_e={},xe={};function Se(){var e,t=[],n=!0;for(var o in _e)_e.hasOwnProperty(o)&&(n=!1,e=_e[o]||"",t.push(we(o)+ye+we(e)));me.name=n?le:he+we(le)+ge+t.join(be)}!function(e){if(e&&0===e.indexOf(he)){var t=e.split(/[:?]/);t.shift(),le=Ie(t.shift())||"";for(var n,o,r,a=t.join("").split(be),i=0,c=a.length;c>i;i++)(n=a[i].match(ve))&&n[1]&&(o=Ie(n[1]),r=Ie(n[2])||"",_e[o]=r)}else le=e||""}(me.name),xe.setItem=function(e,t){e&&void 0!==t&&(_e[e]=t+"",Se())},xe.getItem=function(e){return _e.hasOwnProperty(e)?_e[e]:null},xe.removeItem=function(e){_e.hasOwnProperty(e)&&(_e[e]=null,delete _e[e],Se())},xe.clear=function(){_e={},Se()},xe.valueOf=function(){return _e},xe.toString=function(){var e=me.name;return 0===e.indexOf(he)?e:he+e},de="beforeunload",fe=function(){Se()},(ue=me)&&(ue.addEventListener?ue.addEventListener(de,fe,!1):ue.attachEvent&&ue.attachEvent("on"+de,function(e){fe.call(ue,e)})),me.nameStorage=xe;var Pe=xe;function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ee(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){Ae(e,t,n[t])})}return e}var je={_guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},_initSessionId:function(e){var t=window.sessionStorage,n=e.sessionIdKey;t||(t={}),t[n]||(t[n]="".concat(this._guid(),"_").concat(Date.now())),e.set({sessionId:t[n]})},_initClientId:function(e){var t=window.localStorage,n=e.sessionIdKey;t&&(t[n]||(t[n]="".concat(this._guid(),"_").concat(Date.now())),e.set({clientId:t[n]}))},_initPageId:function(e){if(!e.get("pageId")){var t="".concat(e.spmAPos,".").concat(e.spmBPos,"_").concat(this._guid(),"_").concat(Date.now());e.set({pageId:t})}},_initChInfo:function(e){if(!e.chInfo){var t=c("chInfo")||c("chinfo");t&&e.set({chInfo:t})}},_initFromUrlOrStorage:function(e,t){for(var n=0;t.length>n;n++){var o=t[n],r=c(o)||Pe.getItem("".concat("TRACERT_REF_").concat(o));if(r){var a={};a[o]=r,e.set(a)}}},_initRefs:function(e){this._initFromUrlOrStorage(e,["srcSpm","referPageId","dtLogMonitor","referSPM"]);var t=e.get("srcSpm"),n=e.get("referPageId");t&&n&&e.set({ref:"".concat(t,"|").concat(n)}),e.ignoreNameStorage||(Pe.setItem("".concat("TRACERT_REF_","referPageId"),e.get("pageId")),Pe.setItem("".concat("TRACERT_REF_","dtLogMonitor"),e.get("dtLogMonitor")),window.onunload=function(){var n=e.spmAPos&&e.spmBPos?[e.spmAPos,e.spmBPos].join("."):"";n&&Pe.setItem("".concat("TRACERT_REF_","referSPM"),n),(t=e.get("lastClkSpm"))&&Pe.setItem("".concat("TRACERT_REF_","srcSpm"),t)})},_formatParam:function(e,t){var n=t||{},o=e.spmAPos,r=e.spmBPos,a=n.spmId||"",c=a.split(".").length,s={version:e.version,mBizScenario:e.bizScenario,mPageState:e.state,role_id:e.roleId||e.role_id,fullURL:e.fullURL||location.href,ref:e.refUrl,clientID:e.clientId};if(e.chInfo&&(s.chInfo=e.chInfo),e.dtLogMonitor&&(s.dtLogMonitor=e.dtLogMonitor),e._spmId&&(s._spmId=e._spmId),e._refSpm&&(s._refSpm=e._refSpm),o&&r){if(t.seedId!==e.seedIdCfg.pageSeedId)switch(c){case 1:if(""===a){delete n.spmId;break}n.spmId=[o,r,a].join(".");break;case 2:n.spmId=[o,r,a].join(".");break;case 3:case 4:break;default:n.param2=a,delete n.spmId}}else delete n.spmId;return!n.param2&&n.spmId&&(n.param2=n.spmId),n.param4?i(n.param4,s):n.param4=s,n.param4=Ee({},e.mdata,n.param4),n}},ke={server:curEnv,seedIdCfg:{pageSeedId:"pageMonitor",clkSeedId:"clicked",calcSeedId:"calc",expoSeedId:"exposure",syslogSeedId:"syslog"},refUrl:document.referrer||"-",clientIdKey:"mypaTracert-client-key",init:function(){this._calledInited||(je._initSessionId(this),je._initClientId(this),je._initPageId(this),je._initChInfo(this),je._initRefs(this),this._calledInited=!0)},get:function(e){if("pageId"===e&&!this[e]){if(window._tracert_loader_cfg=window._tracert_loader_cfg||{},window._tracert_loader_cfg.pageId)return this.set({pageId:window._tracert_loader_cfg.pageId}),window._tracert_loader_cfg.pageId;var t=_();t.spmBPos=x();var n=t.spmAPos,o=t.spmBPos,r=n&&o?"".concat(n,".").concat(o,"_").concat(je._guid(),"_").concat(Date.now()):"-_".concat(je._guid(),"_").concat(Date.now());return window._tracert_loader_cfg.pageId=r,this.set({pageId:r}),r}return this[e]},_logPv:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=c("cityId"),n={seedId:this.seedIdCfg.pageSeedId,actionId:this.seedIdCfg.pageSeedId,spmId:this.spmAPos&&this.spmBPos?[this.spmAPos,this.spmBPos].join("."):"",param1:this.url,param2:"",param3:"",param4:Ee({cityid:t},e)};this.call("remoteLog",n)},sendExpose:function(){var e=this,t=setInterval(function(){if(e.cacheExObjArr.length-1<e._wap_exObjIndex)clearTimeout(t);else{var n=e._packFinalData(e.cacheExObjArr[e._wap_exObjIndex]);e._send(n),e._wap_exObjIndex++}},this._wap_intervalEx)},sendMergeExpose:function(){var e=this;this._expoMergeItvObj||(this._expoMergeItvObj=setInterval(function(){if(e.fmtedExObjArr.length-1<e._wap_mgObjIndex)clearTimeout(e._expoMergeItvObj),e._expoMergeItvObj=null;else{var t=e.cacheMrExObjArr[e._wap_mgObjIndex];if(t&&t.length&&t.length-1>=e._wap_mgTdObjIndex){var n=e._packFinalData(t[e._wap_mgTdObjIndex]);e._send(n),e._wap_mgTdObjIndex++}else t&&t.length&&(e._wap_mgTdObjIndex=0,e.mgObjIndex++);var o=e._packFinalData(e.fmtedExObjArr[e._wap_mgObjIndex]);e._send(o),e._wap_mgObjIndex++}},this._wap_interval))},remoteLog:function(e){this.init();var t=this,n=je._formatParam(this,e);if("mergeExpose"===n.actionId&&n.spmId&&3===n.spmId.split(".").length&&n.param4)return this._wap_timer&&clearTimeout(this._wap_timer),this.fmtedExOptions=f(this.fmtedExOptions,i({},n)),this.fmtedExObj=p(this.fmtedExObj,i({},n)),this.fmtedExObjArr=m(this.fmtedExObj,this.fmtedExOptions),void(this._wap_timer=setTimeout(function(){t.cacheMrExObjArr.push(t.fmtedExObjArr),t.fmtedExObj={},t.fmtedExObjArr=[],t.sendMergeExpose()},this._wap_interval));if("exposure"===n.actionId&&n.spmId&&3===n.spmId.split(".").length)return this._wap_timerEx&&clearTimeout(this._wap_timerEx),this.cacheExObjArr.push(n),void(this._wap_timerEx=setTimeout(function(){t.sendExpose()},this._wap_intervalEx));var o=this._packFinalData(n);this._send(o)},_packFinalData:function(e){if("function"==typeof this._beforePackFinalData&&this._beforePackFinalData(e),"object"===Oe(e.param4)){var t=e.param4;for(var n in t)if(t.hasOwnProperty(n)&&"string"==typeof t[n]){var o=t[n].replace(/,/g,"%2C").replace(/\s+/g," ");t[n]="fullURL"===n&&o.length>300?o.slice(0,300):o}}"clicked"===e.actionId&&this.set({lastClkSpm:e.spmId});for(var r=this.refSpm||this.referSPM||"",a=["DW-COOKIE",this.sessionId||"",this.role_id||this.roleId||this.backupUserId||(e.param4&&"3"===e.param4.__ut?this.bucUserId:"")||"",e.actionId||"",e.spmId||e.seedId||"",r||"",this.url&&this.url.length>300?this.url.slice(0,300):this.url||"",this.ref||"".concat(r),"object"===Oe(e.param4)?s(e.param4):e.param4,this.chInfo||"",this.platformType||"",this.pageId||"",navigator.userAgent?navigator.userAgent.replace(/,/g,"%2C"):"","na"===pe.os.name?"PC":"H5","".concat(pe.app.name,"/").concat(pe.app.version,"|").concat(pe.browser.name,"/").concat(pe.browser.fullVersion,"|").concat(pe.os.name,"/").concat(pe.os.fullVersion),this.srcSpm||"",this.referPageId||"",this.bizType||"","",window.innerWidth||"",window.innerHeight||"",window.devicePixelRatio||"","object"===Oe(this.sysInfo)?s(this.sysInfo):"",this.darwinExpId||""],i=0;a.length>i;i++)"string"==typeof a[i]&&(a[i]=a[i].replace(/,/g,"%2C"));return a},_send:function(e){var t=window.encodeURIComponent;(this.debug&&console.log(e),this.server)?(new Image).src="".concat(this.server,"?data=").concat(t(e.join()),"&time=").concat((new Date).getTime(),"&_input_charset=utf-8"):console.warn("请配置Tracert服务接收地址")},send:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clicked",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this._runBeforeFns("send",t),this._spmId&&(t._spmId=this._spmId),this._refSpm&&(t._refSpm=this._refSpm);var o=this._packFinalData({spmId:n||"".concat(this.spmAPos,".").concat(this.spmBPos),actionId:e,param4:t});this._send(o)}},Te=function(e,t){var n=e;return n.set(Ee({},ke)),n.call("init"),t(),n};function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Be="data-aspm-ab",Re="data-aspm-entityid";function Me(e){var t=window.MypaTracert,n=t.getClickSpm(e.target||e.srcElement);if("object"===Ce(n)&&n.spmId){var o=n.dom,r={};b(o,Be)&&(r.abTest=!0),b(o,Re)&&(r.entityId=b(o,Re)),t.call("click",n.spmId,A(o),r)}}var De={spmClickEvent:function(n,o){n&&t(n,window.document,Me),e(o||this.eventType,window.document,Me)},getClickSpm:function(e){var t=P(e),n=O(t),o={dom:t,spmId:""};if(!this.spmAPos||!this.spmBPos)return o;if(t&&n){var r=n.split("."),a=!0;switch(r.length){case 1:r.unshift(S(t))}for(var i=0;2>i;i++)if(!r[i]){a=!1;break}if(a)o.spmId=[this.spmAPos,this.spmBPos].concat(r).join(".")}return o}},ze=function(e,t){return e.set(function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){Le(e,t,n[t])})}return e}({},De)),e.spmClickEvent(),e.before("set",function(t){var n=t;n.eventType=n.eventType||n.eventName,e.spmClickEvent(!!n.eventType&&e.eventType,n.eventType)}),t(),e};function Je(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ne(e,t){return e(t={exports:{}},t.exports),t.exports}var Fe=Ne(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=void 0;return-t>e?o=-1:0>e?o=e/t:n>e+t?o=0:n>e?o=(e+t-n)/t:n>e||(o=1),o},e.exports=t.default});Je(Fe);var Ue=Je(Ne(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,o=(n=Fe)&&n.__esModule?n:{default:n};var r=window.document.documentElement;t.default=function(e){var t=e.getBoundingClientRect();return(0,o.default)(t.top,t.height,r.clientHeight)},e.exports=t.default})),He=Je(Ne(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,o=(n=Fe)&&n.__esModule?n:{default:n};var r=window.document.documentElement;t.default=function(e){var t=e.getBoundingClientRect();return(0,o.default)(t.left,t.width,r.clientWidth)},e.exports=t.default}));function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ve={_getYStatus:function(e){return Ue(e)},_getXStatus:function(e){return He(e)},_doExpo:function(e,t,n){var o=this.expoSection[0],r=this.expoSection[1],a=this.expoObj;if(t&&t.getBoundingClientRect){var i=t.getBoundingClientRect();if(!i.height||!i.width)return}if(!1!==a[e]&&t.offsetParent){void 0===a[e]&&(a[e]=[-1,-1]);var c=this._getYStatus(n),s=this._getXStatus(n);if(!(o>c||c>r||o>s||s>r)){var l=A(t),u=a[e][0],d=a[e][1];o>d?(this.expo(e,"up",l),this.expoOnce&&(a[e]=!1)):d>r?(this.expo(e,"down",l),this.expoOnce&&(a[e]=!1)):o>u?(this.expo(e,"left",l),this.expoOnce&&(a[e]=!1)):u>r&&(this.expo(e,"right",l),this.expoOnce&&(a[e]=!1))}a[e]=!1!==a[e]&&[s,c]}},expoCheck:function(){for(var e=document.querySelectorAll("[data-aspm-expo]"),t=0;e.length>t;t++){var n=e[t],o=this.getExpoSpmDPos(n);if("object"===Ke(o)&&o.spmId||"object"===Ke(o=this.getExpoSpmCPos(n))&&o.spmId)this._doExpo(o.spmId,o.dom,n)}},startAutoExpo:function(){var e=this;this.expoType(function(){e.expoCheck()}),this.expoCheck()},getExpoSpmCPos:function(e){var t={dom:e,spmId:""};if(!this.spmAPos||!this.spmBPos)return t;var n=S(e);return n?(t.spmId=[this.spmAPos,this.spmBPos,n].join("."),t):t},getExpoSpmDPos:function(e){var t=P(e),n=O(t),o={dom:t,spmId:""};if(!this.spmAPos||!this.spmBPos)return o;if(t&&n){var r=n.split("."),a=!0;switch(r.length){case 1:r.unshift(S(t))}for(var i=0;2>i;i++)if(!r[i]){a=!1;break}if(a)o.spmId=[this.spmAPos,this.spmBPos].concat(r).join(".")}return o}},We=function(e,t){var n=e;return n.set(function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){qe(e,t,n[t])})}return e}({},Ve)),n.before("set",function(e){e.autoExpo&&n.call("startAutoExpo")}),t(),n};function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ye=/^http(s)?:\/\/.*[.](taobao|alitrip|alipay|1688|antfortune|taopiaopiao|koubei|ssdata|tmall|alipayobjects|alipay|taobao|alipayobjects|tmall|taopiaopiao|antfortune|1688|alicdn|amap|cainiao|xiami|alibaba|aliyun|alitrip|koubei|weibo|etao|laiwang|taobaocdn|fliggy|yunos|alimama|taohua|antsdaq|juhuasuan|alipay-inc|ssdata|cainiao-inc|xiami|tmall|alibaba|zhimaxy|taobao|alipay|mybank|weibo|etao|taobao|tbcdn|alipay|tmall|fliggy|alitrip|zmxy|sweetmartmarketing|bangdao-tech|alipay-eco|e-mallchina|in66|taeapp|miyapay|10010|10661911|ubike|itoyo|ele|campusnews|qufenqi|aliapp|chidaoni)[.](com|net|hk|me)$/g,Xe=window.location.origin,$e=function(e){var t=Xe.match(Ye);if(t&&t.length){var n=e||window.MypaTracert,o="__",r="",a={src:1,rid:1,sid:1,time:1},s={ch:1,tanxid:1,adid:1,wid:1};i(n,{initDtLogMonitor:function(){var e=window.AlipayJSBridge.startupParams,t=c("dtLogMonitor")||e.dtLogMonitor;try{t=decodeURIComponent(t)}catch(e){n.call("info",{seedId:"H5_PAGE_DtLogMoinitor_PARSEERR",params:{startupDtLog:t},logLevel:"3"})}var a,i=d(t),p=i.otherObj,m=!1,h=function(){setTimeout(function(){f(function(e){var t=[];e.otherArr.length?AlipayJSBridge.call("getAPDataStorage",{type:"preferences",business:"DTSchemeServiceImpl",key:"dtLogMonitorTime"},function(n){var a=n.data||"";t=(t=t.concat(e.otherArr)).concat(i.blackArr),a&&t.push("time_".concat(a)),r=t.join(o),l(t)}):(t=t.concat(i.blackArr),r=t.join(o),l(t))})},10)};for(a in s)if(p[a]){m=!0;break}!m&&i.otherArr.length||"20000837"===e.appId?f(function(e){var t=[],n=e.otherObj;if("object"===Ge(n))for(a in s)n.hasOwnProperty(a)&&n[a]&&t.push("".concat(a,"_").concat(n[a]));u(t=t.concat(i.otherArr)),h()}):i.otherArr.length?(u(i.otherArr),h()):h()},dtLogMonitor:function(e,t){var n=t;if("function"==typeof e&&(n=e),n||(n=function(){}),"object"!==Ge(e))n(r,r);else{var i,c=d(r),s=c.blackObj,l=[];for(i in a)"time"!==i&&(e[i]&&(s[i]=e[i]),s[i]&&l.push("".concat(i,"_").concat(s[i])));c.time&&l.push("time_".concat(c.time)),t(c.otherArr.concat(l).join(o),r)}}}),n.call("initDtLogMonitor")}else console.log("外部域名，不做dtlogmonitor实例化");function l(e){var t=[].concat(e);t.length&&n.call("info",{seedId:"H5_PAGE_DtLogMoinitor_UPLOAD",params:{dtLogMonitor:t.join(o)},logLevel:"3"})}function u(e){var t=[].concat(e).join(o),r="".concat(parseInt((new Date-0)/1e3,10));AlipayJSBridge.call("setAPDataStorage",{type:"preferences",business:"DTSchemeServiceImpl",key:"dtLogMonitor",value:t}),AlipayJSBridge.call("setAPDataStorage",{type:"preferences",business:"DTSchemeServiceImpl",key:"dtLogMonitorTime",value:r}),n.call("info",{seedId:"H5_PAGE_DtLogMoinitor_SAVE",params:{dtLogMonitor:t,dtLogMonitorTime:r},logLevel:"3"})}function d(e){var t,n={},r=[],i={},c=[];if(e)try{var s,l,u,d,f=e.split(o),p=f.length;for(l=0;p>l;l++)(s=f[l])&&(u=(s=s.split("_"))[0],(d=s[1])&&("time"===u?t=d:a[u]?(n[u]=d,r.push("".concat(u,"_").concat(d))):(i[u]=d,c.push("".concat(u,"_").concat(d)))))}catch(e){console.warn(e)}return{blackObj:n,blackArr:r,otherObj:i,otherArr:c,time:t}}function f(e){AlipayJSBridge.call("getAPDataStorage",{type:"preferences",business:"DTSchemeServiceImpl",key:"dtLogMonitor"},function(t){var n,o="";1!==t.error&&11!==t.error&&t.data&&(o="".concat(t.data)),"function"==typeof e&&(n=d(o),e(n))})}};function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var et="data-asem",tt={getSemDom:function(e){var t=e;if(!I(t))return null;do{if(t.hasAttribute(et)&&t.hasAttribute("data-asem-params"))return t}while((t=t.parentNode)&&t&&t.tagName&&"BODY"!==t.tagName&&t!==document.body);return null},getSemId:function(e){var t=e;if(!I(t))return"";if(t.hasAttribute(et)&&t.hasAttribute("data-asem-params")&&(t=this.getSemDom(t)),!t)return"";var n=b(t,et);return"".concat(n)},getSemParams:function(e){var t=e;if(!I(t))return"";if(t.hasAttribute(et)&&t.hasAttribute("data-asem-params")&&(t=this.getSemDom(t)),!t)return"";var n=b(t,"data-asem-params");return"".concat(n)},getClickSem:function(e){var t=this.getSemDom(e);return{semId:this.getSemId(t),params:this.getSemParams(t)}},formatRemoteParams:function(e){var t=e,n=i({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),o=n.param4||n.params||{};return n.params&&delete n.params,i(n,{bizType:n.bizType||t.bizType,actionId:n.actionId||"semclk",param4:o}),n}};function nt(e){var t=window.MypaTracert,n=tt.getClickSem(e.target||e.srcElement);"object"===Qe(n)&&n.semId&&(n.actionId="semclk",t.call("sem",n),t.setLastClkSem(n))}var ot={lastClkSem:"",semClickEvent:function(n,o){n&&t(n,window.document,nt),e(o||this.eventType,window.document,nt)},setLastClkSem:function(e){var t=e.semId,n=e.params;"object"!==Qe(n)&&(n=l(n));var o=n.rid;o?this.lastClkSem="semId_".concat(t,"__rpcId_").concat(o):console.warn("sem扩展参数，缺省rid字段，无法正确上报")},sem:function(e){var t=tt.formatRemoteParams(this,e),n={};if(i(n,t),this.debug){var o={};i(o,t),console.log(o)}"string"!=typeof n.param4&&(n.param4=s(n.param4)),window.AlipayJSBridge.call("semLog",n)}};function rt(e,t){for(var n=0;t.length>n;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function at(){}var it=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mypaTracert=t,this.trace=!!c("trace"),this.chinfo=c("chinfo")||c("chInfo")||"",this.scm=c("scm")||"",this.isPageInfoLogged=!1,this.isChinfoChainPushed=!1,this.start()}var t,n,o;return t=e,(n=[{key:"start",value:function(){this.trace&&this._setPageInfo(),this.chinfo&&this._setChinfo()}},{key:"getChinfoChain",value:function(e){window.AlipayJSBridge.call("handleLoggingAction",{actionType:"getChinfoChain"},function(t){var n="function"==typeof e?e:at;"success"===t.status?n(t.data?JSON.parse(t.data):{err:"容器返回数据类型有误"}):n({err:"容器异常"})})}},{key:"_setPageInfo",value:function(){var e=this;this.mypaTracert.after("logPv",function(){window.AlipayJSBridge.call("handleLoggingAction",{actionType:"setPageParams",data:JSON.stringify({chinfo:e.chinfo,scm:e.scm})})}),this.isPageInfoLogged=!0}},{key:"_setChinfo",value:function(){window.AlipayJSBridge.call("handleLoggingAction",{actionType:"appendChinfo",data:JSON.stringify({chinfo:this.chinfo,scm:this.scm})}),this.isChinfoChainPushed=!0}}])&&rt(t.prototype,n),o&&rt(t,o),e}(),ct=window,st=function(e){return X(e)},lt=function(){ct.BizLog&&"function"==typeof ct.BizLog.call&&(ct.BizLog.call("config",{disabled:!0}),"function"==typeof document.addEventListener&&document.addEventListener("AlipayJSBridgeReady",function(){ct.BizLog.call("config",{disabled:!0})},!1))},ut=function(e){if(ct.BizLog){var t=ct.BizLog._readyToRun,n=ct.BizLog||{};if(n.call=function(){for(var t=arguments.length,n=[],o=0;t>o;o++)n[o]=arguments[o];return e.call.apply(e,n)},t&&t.length)for(var o=0;t.length>o;o++){var r=t[o];try{r()}catch(e){console.warn(e)}}ct.BizLog=n}},dt=function(e){if(ct.MypaTracert&&ct.MypaTracert._isInit){var t=ct.MypaTracert._readyToRun;if(ct.MypaTracert.call=function(){for(var t=arguments.length,n=[],o=0;t>o;o++)n[o]=arguments[o];return e.call.apply(e,n)},t&&t.length)for(var n=0;t.length>n;n++){var o=t[n];try{o()}catch(e){console.warn(e)}}}var r=c("lanInfo")||c("laninfo");r&&e.set({mdata:{lanInfo:r}}),e.set(window._to||{}),e.set(window._tracert_loader_cfg||{}),e.set({parse:l,stringify:s}),e.run(),ct.MypaTracert=e},ft=window;if(!ft.MypaTracert||ft.MypaTracert._isInit){var pt=new N({_v:"3.1.2"}),mt=st(ft.navigator.userAgent);pt.loadPlugins(["TB","TM","JU"].indexOf(mt.name)>"-1"?[Te,function(e,t){var n=e;return r(function(){var e=window.lib,o=window.WindVane,r=function(){e&&e.mtop&&"function"==typeof e.mtop.request?e.mtop.request({api:"mtop.taobao.wireless.alipay.getAlipayId",v:"1.0",data:{},ecode:1,timeout:1500},function(e){e&&e.data&&e.data.alipayId?(n.set({role_id:e.data.alipayId}),t()):t()},function(e){console.log("MypaTracert 未获取到支付宝uid",e),t()}):t()};o&&o.call?o.call("TBDeviceInfo","getUtdid",{},function(e){var t=e.utdid;t?(n.set({mdata:{utdid:t}}),r()):r()},function(e){console.log("MypaTracert 获取utdid失败",e),r()}):r()}),n},ze,We]:["LX"].indexOf(mt.name)>"-1"?[Te,function(e,t){var n=e;return r(function(){var e=window.alitripBridge;e&&e.call&&"function"==typeof e.call?e.call("user_info",{successCallback:function(e){e&&e.userId?(n.set({role_id:e.userId}),t()):t()},failCallback:function(e){console.log("MypaTracert 未获取到支付宝uid",e),t()}}):t()}),n},ze,We]:["QN"].indexOf(mt.name)>"-1"?[Te,function(e,t){var n=e;return r(function(){var e=window.WindVane;e&&e.call&&"function"==typeof e.call?window.WindVane.call("QianNiu","getUserInfo",{},function(e){if(!e||!e.user_id)return console.log("MypaTracert 未获取到千牛uid",e),void t();n.set({role_id:e.user_id}),t()},function(e){console.log("MypaTracert 未获取到千牛uid",e),t()}):t()}),n},ze,We]:[Te,ze,We]),lt(),dt(pt),ut(pt)}return ft.MypaTracert});
